{% assign speed = settings.slider_interval %}
if(document.querySelector('#sort_by')!=null) {
    document.querySelector('#sort_by').addEventListener('change', function (e) {
        let url = new URL(window.location.href);
        url.searchParams.set('sort_by', e.currentTarget.value)
        window.location = url.href
    })
}

if(document.querySelector('#AddressCountryNew')!=null){
    document.getElementById('AddressCountryNew').addEventListener('change', function (e){
        //let provinces = this.options[this.selectedIndex].getAttribute('data-provinces')
        let provinces = this.options[this.selectedIndex].dataset.provinces
        let provinceSelector = document.getElementById('AddressProvinceNew')
        let provinceArray = JSON.parse(provinces) // распарсили провинции
        // console.log(provinces) // а так будет закодированая JSON строка
        if(provinceArray.length < 1){
            provinceSelector.setAttribute('disabled', 'disabled')
        }else{
            provinceSelector.removeAttribute('disabled')
        }
        provinceSelector.innerHTML = ''
        var options = ''
        for(var i = 0; i<provinceArray.length; i++ ){
            options += '<option value="'+ provinceArray[i][0] +'"> '+ provinceArray[i][0] +' </option>'
        }
        provinceSelector.innerHTML = options
    })
}
if(document.getElementById('forgotPassword')!=null){
    document.getElementById("forgotPassword").addEventListener('click', function (e){
        document.getElementById("forgot_password_form").classList.toggle('d-none')

       // const element = document.getElementById("forgot_password_form");
       // if(element.classList.contains("d-none")){
       //     element.classList.remove("d-none")
       //     element.classList.add("d-block")
       // }
    })
}

var localeItems = document.querySelectorAll("#localeItem")
if(localeItems.length > 0){
    localeItems.forEach(item =>{
        //console.log(item)
        item.addEventListener("click", event=>{
            document.getElementById("localCode").value=item.getAttribute("lang")
            document.getElementById("localization_form_tag").submit()
        })
    })
}


var myCarousel = document.querySelector('#carouselExampleControls')
var carousel = new bootstrap.Carousel(myCarousel, {
   interval: {{ speed }}*1000
})

var productModal = new bootstrap.Modal(document.getElementById('productInfoModal'),{})
var productInfoAnchor = document.querySelectorAll("#productInfoAnchor")
if(productInfoAnchor.length>0){
    productInfoAnchor.forEach((item)=>{
        item.addEventListener("click",function (event) {
            var url = '/products/' + item.getAttribute('product-handle') + '.js'
            // console.log(url) // /products/product-without-images.js
            fetch(url)
                .then((resp) => resp.json())
                .then(function (data) {
                    console.log(data)
                    document.getElementById('productInfoImg').src = data.images[0]
                    document.getElementById('productInfoTitle').innerHTML = data.title
                    document.getElementById('productInfoPrice').innerHTML = item.getAttribute('product-price')
                    document.getElementById('productInfoDescription').innerHTML = data.description
                    document.getElementById('productVariantPrice').innerHTML = data.variants[0].price

                    data.variants.forEach(variant=>{
                        document.getElementById('productVariantSelect').innerHTML += `<option>${variant.title}</option>`
                    })
                    productModal.show()
                });
        })
    })
}